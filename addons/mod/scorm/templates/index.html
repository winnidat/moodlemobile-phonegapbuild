<ion-view>
    <ion-nav-title><mm-format-text watch="true">{{ title }}</mm-format-text></ion-nav-title>
    <ion-nav-buttons side="secondary">
        <mm-context-menu>
            <mm-context-menu-item priority="900" ng-if="moduleUrl" href="moduleUrl" content="'mm.core.openinbrowser' | translate" icon-action="'ion-share'"></mm-context-menu-item>
            <mm-context-menu-item priority="800" ng-if="description" content="'mm.core.moduleintro' | translate" action="expandDescription()" icon-action="'ion-arrow-right-c'"></mm-context-menu-item>
            <mm-context-menu-item priority="700" ng-if="scormLoaded && !hasOffline && isOnline" content="'mm.core.refresh' | translate" action="refreshScorm(false)" icon-action="refreshIcon" close-on-click="false" close-when-done="true"></mm-context-menu-item>
            <mm-context-menu-item priority="600" ng-if="scormLoaded && hasOffline && isOnline" content="'mm.settings.synchronizenow' | translate" action="refreshScorm(true)" icon-action="syncIcon" close-on-click="false" close-when-done="true"></mm-context-menu-item>
            <mm-context-menu-item priority="550" ng-if="prefetchStatusIcon" content="timemodified" icon-action="prefetchStatusIcon" action="prefetch()" close-on-click="false"></mm-context-menu-item>
            <mm-context-menu-item priority="500" ng-if="size" content="size" icon-description="'ion-cube'" icon-action="'ion-trash-a'" action="removeFiles()"></mm-context-menu-item>
        </mm-context-menu>
    </ion-nav-buttons>
    <ion-content padding="true" delegate-handle="mmaModScormIndexScroll" mm-state-class>
    	<ion-refresher pulling-text="{{ 'mm.core.pulltorefresh' | translate }}" ng-if="scormLoaded" on-refresh="refreshScorm(false)">
        </ion-refresher>
        <mm-loading hide-until="scormLoaded">
	        <mm-course-mod-description watch="true" description="description" component="{{component}}" component-id="{{componentId}}"></mm-course-mod-description>

	            <!-- Open SCORM in app form -->
                <form class="card" ng-if="!errorMessage && (!scorm.lastattemptlock || scorm.attemptsLeft > 0)" ng-submit="open($event)">
               		<!-- Open mode (Preview or Normal) -->
                	<div class="item" ng-if="!scorm.hidebrowse">
                		<p class="item-heading">{{ 'mma.mod_scorm.mode' | translate }}</p>
                		<p class="mma-mod-scorm-checkbox-padding">
                			<input type="radio" name="mode" ng-model="scormOptions.mode" value="{{modebrowse}}" aria-labelledby="mma-mod_scorm-browse">
                			<span id="mma-mod_scorm-browse">{{ 'mma.mod_scorm.browse' | translate }}</span>
                		</p>
                		<p class="mma-mod-scorm-checkbox-padding">
                			<input type="radio" name="mode" ng-model="scormOptions.mode" value="{{modenormal}}" aria-labelledby="mma-mod_scorm-normal">
                			<span id="mma-mod_scorm-normal">{{ 'mma.mod_scorm.normal' | translate }}</span>
                		</p>
                	</div>
               		<!-- Create new attempt -->
                    <ion-checkbox ng-if="!scorm.forcenewattempt && scorm.numAttempts > 0 && !scorm.incomplete && scorm.attemptsLeft > 0" class="item-text-wrap item-checkbox-right" ng-model="scormOptions.newAttempt">
                        <p class="item-heading">{{ 'mma.mod_scorm.newattempt' | translate }}</p>
                    </ion-checkbox>
                	<div class="item item-text-wrap" ng-if="!downloading">
                		<p ng-if="statusMessage">{{ statusMessage | translate }}</p>
	                    <button class="button button-block button-positive">{{ 'mma.mod_scorm.enter' | translate }}</button>
                	</div>
                	<div class="item text-center" ng-if="downloading">
	                	<ion-spinner></ion-spinner>
	                	<p ng-if="progressMessage">{{ progressMessage | translate }}</p>
	                	<p ng-if="percentage <= 100">{{ 'mm.core.percentagenumber' | translate:{$a: percentage} }}</p>
	                </div>
                </form>
	        </div>
	    </mm-loading>
    </ion-content>
</ion-view>